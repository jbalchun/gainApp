var app=angular.module("MyApp.timercontrol",[]);app.controller("timercontrol",["$scope","$ionicPopup","$timeout","$rootScope",function(t,e,n,o){t.rangeMin={min:1},t.rangeSec={sec:30},t.startStopFlag=!0,t.timerClear=!0,t.stringMin=String(t.rangeMin),t.stringSec=String(t.rangeSec),t.infoFlag=4,t.loopFlag=!1,t.$watch("minutes",function(){t.stringMin=String(t.minutes),t.stringMin.length<2&&(t.stringMin="0"+String(t.minutes))}),t.$watch("seconds",function(){t.stringSec=String(t.seconds),t.stringSec.length<2&&(t.stringSec="0"+String(t.seconds))}),t.cycle=function(){t.loopFlag=!t.loopFlag,t.startStop()},t.showInfo=function(){"heroku"==o.stateW&&winston.log("info",t.$storage.userId+", viewed timer info at "+new Date);var n=e.show({title:"Timer",scope:t,templateUrl:"pop/pop-maininfo.html",buttons:[{text:"<b>Done</b>",type:"button-dark",onTap:function(t){}}]});n.then(function(e){"heroku"==o.stateW&&winston.log("info",t.$storage.userId+", closed timer info at "+new Date)})},t.timerPreset=function(e,o){console.log(e,o);var r=function(e,n){t.rangeMin.min=n,t.rangeSec.sec=e,t.$broadcast("timer-reset"),t.minutes=n,t.seconds=e};r(e,o),n(function(){r(e,o)},5),t.startStopFlag=!0},t.upOneMin=function(){t.startStopFlag&&t.rangeMin.min<30&&(t.rangeMin.min=parseFloat(t.rangeMin.min)+1,t.$broadcast("timer-reset"),n(function(){t.$broadcast("timer-reset")},5))},t.downOneMin=function(){t.startStopFlag&&(t.rangeMin.min>0&&(t.rangeMin.min=parseFloat(t.rangeMin.min)-1,t.$broadcast("timer-reset")),n(function(){t.$broadcast("timer-reset")},5))},t.upOneSec=function(){t.startStopFlag&&(t.rangeSec.sec<59&&(t.rangeSec.sec=parseFloat(t.rangeSec.sec)+1,t.$broadcast("timer-reset")),n(function(){t.$broadcast("timer-reset")},5))},t.downOneSec=function(){t.rangeSec.sec&&(t.rangeSec>0&&(t.rangeSec.sec=parseFloat(t.rangeSec.sec)-1,t.$broadcast("timer-reset")),n(function(){t.$broadcast("timer-reset")},5))},t.onRelease=function(){if(console.log("working"),t.startStopFlag){console.log("working,",t.rangeSec.sec,t.rangeMin.min);var e=Number(t.rangeMin.min),n=Number(t.rangeSec.sec);t.timerPreset(n,e)}},t.seconds1=function(){return Number(60*t.rangeMin.min)+Number(t.rangeSec.sec)},t.$on("$ionicView.beforeEnter",function(e,n){n.fromCache||"tab.timer"!=n.stateName||(console.log("got it timer"),t.startStopFlag=!0)}),t.startStop=function(){t.startStopFlag?t.timerClear?(t.$broadcast("timer-start"),t.timerClear=!1):t.$broadcast("timer-resume"):(t.$broadcast("timer-stop"),t.loopFlag&&(t.loopFlag=!1)),t.startStopFlag=!t.startStopFlag},t.reset=function(){console.log(t.loopFlag),t.loopFlag&&(console.log("init"),t.loopFlag=!1,t.$broadcast("timer-reset")),0==t.timerClear&&(t.$broadcast("timer-reset"),t.minutes=0,t.seconds=0,t.startStopFlag=!0)},t.finished=function(){t.startStopFlag=!0;var n=e.alert({title:"Times up!",template:""});t.loopFlag&&(n.close(),t.$broadcast("timer-reset"),t.startStop()),n.then(function(t){})},t.timerToggle=function(){t.$broadcast("timer-stop")}}]);