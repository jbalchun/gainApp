var app=angular.module("MyApp.services",["ngStorage"]);app.factory("Post",function(){return{find:function(t){this.posts[t]},add:function(t){this.posts.push({id:this.posts.length,url:t.url,title:t.title})},posts:[{id:0,url:"#/some-url/0",title:"How to do item A"},{id:1,url:"#/some-url/1",title:"How to do item B"},{id:2,url:"#/some-url/2",title:"YOLO"}]}}),app.factory("UserData",function(){}),app.factory("localStore",["$rootScope","$localStorage","$timeout",function(t,e,a){var r=function(t){var e=new Date(t);e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var a=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-a.getTime())/864e5-3+(a.getDay()+6)%7)/7)},o=function(){t.$broadcast("clear-cal")};return{addLift:function(e,a,r){t.$storage.todaysLifts.push({name:e,sets:a,"super":r})},saveLift:function(e,a,r,o,n){t.$storage.workouts.unshift({date:e,name:r.name,bodyWeight:o.wt,lifts:a,notes:n.notes}),t.$storage.nameList[r.name+e]=r.name,t.$storage.todaysLifts=[{name:"Select Lift",sets:[{reps:"0",wt:"0"}],"super":!1}],t.$broadcast("calRefresh")},removeWorkout:function(e){angular.forEach(t.$storage.workouts,function(a,r){e.date==a.date&&t.$storage.workouts.splice(r,1)}),angular.forEach(t.$storage.nameList,function(a,r){console.log("name",a,"key",r,"targetttt",e.name+e.date),delete t.$storage.nameList[e.name+e.date]})},checkDay:function(e){var a=!1;return angular.forEach(t.$storage.workouts,function(t,r){var o=Number(t.date.slice(3,6)),n=Number(e);o==n&&(a=!0)}),a},checkDate:function(e){var a=!1;return angular.forEach(t.$storage.workouts,function(t,r){t.date==e&&(a=!0)}),a},clearLifts:function(){t.$storage.todaysLifts=[{name:"Select Lift",sets:[{reps:"0",wt:"0"}]}]},clearAll:function(){e.$reset(),t.$storage.todaysLifts=[{name:"Select Lift",sets:[{reps:"0",wt:"0"}]}],t.$storage.populated=!0,t.$storage.firstVisit=!1,location.reload(),o()},clearLiftsOnly:function(){t.$storage.workouts={},t.$storage.nameList={},t.$storage.todaysLifts=[{name:"Select Lift",sets:[{reps:"0",wt:"0"}]}],o()},addSet:function(e){if(t.$storage.todaysLifts[e].sets.length<10){var a=angular.copy(_.last(t.$storage.todaysLifts[e].sets));t.$storage.todaysLifts[e].sets.push(a)}},removeSet:function(e){t.$storage.todaysLifts[e].sets.length>1&&t.$storage.todaysLifts[e].sets.splice(-1,1)},buildKgMap:function(){t.$storage.kgMap={},angular.forEach(t.$storage.liftData,function(e,a){t.$storage.kgMap[e.name]="heavykg"==e.weight?"kgs":"lbs"})},getChartData:function(e,a,r){var o=[],n=[],s=[],i={};if(angular.forEach(t.$storage.workouts,function(t,r){angular.forEach(t.lifts,function(r,u){r.name==e&&angular.forEach(r.sets,function(e,u){if(Number(e.reps)==Number(a))if(i[String(r.name)+String(e.reps)+String(t.date)]>0){var g=Number(i[String(r.name)+String(e.reps)+String(t.date)]);g<e.wt&&(o.pop(),s.pop(),o.push(Number(e.wt)),s.push({wt:Number(e.wt),date:t.date}))}else i[String(r.name)+String(e.reps)+String(t.date)]=Number(e.wt),o.push(Number(e.wt)),n.push(t.date),s.push({wt:Number(e.wt),date:t.date})})})}),1==r){0==o.length&&(o=[0]);var u=[o];return u}return 2==r?(0==n.length&&(n=["","No Data Available"]),n):s},removeLiftEntry:function(e){angular.forEach(t.$storage.liftData,function(a,r){a.name==e&&t.$storage.liftData.splice(r,1)})},addLiftToList:function(e){t.$storage.liftData.unshift({name:e,attr1:".",attr2:".",attr3:".",custom:!0,weight:"heavy"})},getLiftByName:function(e){var a={};return angular.forEach(t.$storage.liftData,function(t,r){e==t.name&&(a=t)}),a},loadLiftFromCalendar:function(e){angular.forEach(t.$storage.workouts,function(a,r){console.log("name",e.name,e.date),e.name==a.name&&e.date==a.date&&(t.$storage.todaysLifts=angular.copy(a.lifts))}),console.log("name",e.name),e.name&&(console.log("adding name"),t.$storage.tabTitle=e.name)},wipeWeights:function(){angular.forEach(t.$storage.todaysLifts,function(t,e){angular.forEach(t.sets,function(t,e){t.wt=0})}),t.$broadcast("loadedFromCalendar")},liftsOnly:function(){angular.forEach(t.$storage.todaysLifts,function(t,e){t.sets=[{reps:"0",wt:"0"}]}),t.$broadcast("loadedFromCalendar")},makeCalendar:function(){return{$storage:e,workouts:$storage.workouts,filterList:angular.copy($storage.workouts),searchQuery:"",dateType:"",today:new Date,dateObj:{Year:"Year",Month:"Month",Day:"Day"},$storage:e,nameList:$storage.nameList,nameFilter:"Name",liftName:"Lift",monthMap:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},calendar1:!0,infoFlag:2}},buildRepList:function(e){var a=[];angular.forEach(t.$storage.workouts,function(t,r){angular.forEach(t.lifts,function(t,r){t.name==e&&angular.forEach(t.sets,function(t,e){a.push(Number(t.reps))})})});var r=_.unique(a),o=r.sort(function(t,e){return t-e}),n=[];return angular.forEach(o,function(t,e){n.push({reps:Number(t)})}),void 0==n[0]&&(n=[{reps:0}]),n},getBodyWeightData:function(e){var a=[],r=[];if(angular.forEach(t.$storage.workouts,function(t,e){t.bodyWeight&&(a.push(t.bodyWeight),r.push(t.date))}),1==e){0==a.length&&(a=[0]);var o=[a];return o}return 0==r.length&&(r=["","No Data Available"]),r},getMax:function(e,a){var r=[],o=[];angular.forEach(t.$storage.workouts,function(t,n){o.push({wt:t.bodyWeight,date:t.date}),angular.forEach(t.lifts,function(o,s){if(n>0&&o.name==e){var i=[];angular.forEach(o.sets,function(e,r){Number(e.reps)==Number(a)&&(console.log("reps",a),i.push({wt:Number(e.wt),date:t.date}))});var u=_.max(i,function(t){return t.wt});r.push(u)}})});var n=_.max(r,function(t){return t.wt});return 1==r.length&&(n.only1=!0),"Body Weight"==e&&(n=o),n},updateGoals:function(e){angular.forEach(e,function(e,a){console.log("inserted goal for:",a),t.$storage.goalsMap[a]=e,console.log(t.$storage.goalsMap)})},getGoal:function(e){return t.$storage.goalsMap[e]},setStartTime:function(e,a){t.$storage.startTime=+new Date,console.log("timetrace",t.$storage.startTime,e,a),t.$storage.min=e,t.$storage.sec=a,console.log("timetrace2",t.$storage.startTime,t.$storage.min,t.$storage.sec)},getStartTime:function(){return t.$storage.startTime},getStartMinSec:function(){return console.log("starttime return",{min:t.$storage.min,sec:t.$storage.sec}),{min:angular.copy(t.$storage.min),sec:angular.copy(t.$storage.sec)}},resetStartTime:function(){t.$storage.startTime=0,t.$storage.min=0,t.$storage.sec=0},setSelectedCycle:function(e){t.$storage.selectedCycle=e},getSelectedCycle:function(e){return t.$storage.selectedCycle},getMillisecondsFromMinSec:function(){var e=t.$storage.min,a=t.$storage.sec,r=60*e*1e3+1e3*a;return r},normalizeToWeeks:function(t,e){var a="none",o=[],n=[],s=t,i=r(s[0].date);a=i;var u=r(s[0].date),g=r(s[s.length-1].date),l=g-u,c=new Date(t[0].date),f=new Date(s[s.length-1].date);if(c.getFullYear()!=f.getFullYear()&&53!=g){var d=f.getFullYear()-c.getFullYear();g+=52*d,l=g-u}var m={},h={};angular.forEach(s,function(t,e){var a=r(t.date)-u,o=new Date(t.date);if(o.getFullYear()!=c.getFullYear()&&53!=a&&(a+=52*(o.getFullYear()-c.getFullYear())),h[a]){var n=_.max([Number(h[a].wt),Number(t.wt)]);m[a]={date:t.date,wt:n},h[a]={date:t,wt:n}}else h[a]=t,m[a]=t});for(var p,$=[],w=[],y=[],v=0,L=[],b=0;l+1>b;b++)$[b]=String(b),m[b]&&m[b].hasOwnProperty("wt")?(y[b]=Number(m[b].wt),L[b]=m[b].date,$[b]=String(b),v=m[b].wt,p=new Date(m[b].date)):y[b]=Number(v);w[0]=y;var o=$,n=[y];return 1==e?n:2==e?o:L}}}]);