!function(e,t){function n(e){var t;if(e=parseInt(e,10),!e||1>e)return"";for(t="";e;)t+="0",e-=1;return t}function r(e,t,r){return null==e&&(e=""),e=""+e,(r?e:"")+n(t-e.length)+(r?"":e)}function i(e,t){for(var n,r=e.length;r--;)if(t(e[r])>0){n=e[r];break}return n}var s,o,a="function"==typeof require;if(a)o=require("lodash")||require("underscore");else{if(!e._)throw"Moment Duration Format cannot find Lo-Dash or Underscore";o=e._}if(a)s=require("moment");else{if(!e.moment)throw"Moment Duration Format cannot find Moment.js";s=e.moment}s.duration.fn.format=function(){var e,t,i,a,u,c,l,f=[].slice.call(arguments),p=o.extend({},this.format.defaults),m=s.duration(this);return p.duration=this,o.each(f,function(e){return"string"==typeof e||"function"==typeof e?void(p.template=e):"number"==typeof e?void(p.precision=e):void(o.isObject(e)&&o.extend(p,e))}),i=p.types=o.isArray(p.types)?p.types:p.types.split(" "),"function"==typeof p.template&&(p.template=p.template.apply(p)),e=new RegExp(o.map(i,function(e){return p[e].source}).join("|"),"g"),a=function(e){return o.find(i,function(t){return p[t].test(e)})},t=o.map(p.template.match(e),function(e,t){var n=a(e),r=e.length;return{index:t,length:r,token:"escape"===n?e.replace(p.escape,"$1"):e,type:"escape"===n||"general"===n?null:n}},this),u=o.intersection(i,o.unique(o.compact(o.pluck(t,"type")))),u.length?(o.each(u,function(e,n){var r,i,s,a,c;r=m.as(e),i=r>0?Math.floor(r):Math.ceil(r),s=r-i,a=n+1===u.length,c=!n,o.each(t,function(t){t.type===e&&(o.extend(t,{value:r,wholeValue:i,decimalValue:s,isLeast:a,isMost:c}),c&&null==p.forceLength&&t.length>1&&(p.forceLength=!0))}),m.subtract(i,e)}),p.trim&&(c=!1,l=o["left"===p.trim?"reduce":"reduceRight"](t,function(e,t,n){return c||t.isLeast||null!=t.type&&t.wholeValue?(c=!0,e):n},-1),-1!==l&&(t=o["left"===p.trim?"rest":"first"](t,"left"===p.trim?l+1:l))),c=!1,"right"===p.trim&&t.reverse(),t=o.map(t,function(e){var t,i;if(!e.type)return e.token;if(t=e.isLeast&&p.precision<0?(Math.floor(e.wholeValue*Math.pow(10,p.precision))*Math.pow(10,-p.precision)).toString():e.wholeValue.toString(),t=t.replace(/^\-/,""),e.length>1&&(c||e.isMost||p.forceLength)&&(t=r(t,e.length)),e.isLeast&&p.precision>0)switch(i=e.decimalValue.toString().replace(/^\-/,"").split(/\.|e\-/),i.length){case 1:t+="."+r(i[0],p.precision,!0).slice(0,p.precision);break;case 2:t+="."+r(i[1],p.precision,!0).slice(0,p.precision);break;case 3:t+="."+r(n(+i[2]-1)+(i[0]||"0")+i[1],p.precision,!0).slice(0,p.precision);break;default:throw"Moment Duration Format: unable to parse token decimal value."}return e.isMost&&e.value<0&&(t="-"+t),c=!0,t}),"right"===p.trim&&t.reverse(),t.join("")):o.pluck(t,"token").join("")},s.duration.fn.format.defaults={escape:/\[(.+?)\]/,years:/[Yy]+/,months:/M+/,weeks:/[Ww]+/,days:/[Dd]+/,hours:/[Hh]+/,minutes:/m+/,seconds:/s+/,milliseconds:/S+/,general:/.+?/,types:"escape years months weeks days hours minutes seconds milliseconds general",trim:"left",precision:0,forceLength:null,template:function(){var e,t=this.types,n=this.duration;switch(e="function"==typeof o.findLast?o.findLast(t,function(e){return n._data[e]}):i(t,function(e){return n._data[e]})){case"seconds":return"h:mm:ss";case"minutes":return"d[d] h:mm";case"hours":return"d[d] h[h]";case"days":return"M[m] d[d]";case"weeks":return"y[y] w[w]";case"months":return"y[y] M[m]";case"years":return"y[y]";default:return"y[y] M[m] d[d] h:mm:ss"}}}}(this);