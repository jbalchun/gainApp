var app=angular.module("MyApp.services",["ngStorage"]);app.factory("Post",function(){return{find:function(t){this.posts[t]},add:function(t){this.posts.push({id:this.posts.length,url:t.url,title:t.title})},posts:[{id:0,url:"#/some-url/0",title:"How to do item A"},{id:1,url:"#/some-url/1",title:"How to do item B"},{id:2,url:"#/some-url/2",title:"YOLO"}]}}),app.factory("UserData",function(){}),app.factory("localStore",["$rootScope","$localStorage",function(t,a){var e=function(t){var a=new Date(t);a.setHours(0,0,0,0),a.setDate(a.getDate()+3-(a.getDay()+6)%7);var e=new Date(a.getFullYear(),0,4);return 1+Math.round(((a.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)};return{addLift:function(a,e){t.$storage.todaysLifts.push({name:a,sets:e,"super":!1})},saveLift:function(a,e,r,o,n){t.$storage.workouts.unshift({date:a,name:r.name,bodyWeight:o.wt,lifts:e,notes:n.notes}),t.$storage.nameList[r.name+a]=r.name,t.$storage.todaysLifts=[{name:"Select Lift",sets:[{reps:"0",wt:"0"}],"super":!1}],t.$broadcast("calRefresh")},removeWorkout:function(a){angular.forEach(t.$storage.workouts,function(e,r){a.date==e.date&&t.$storage.workouts.splice(r,1)}),angular.forEach(t.$storage.nameList,function(e,r){a.name==e&&delete t.$storage.nameList[r]})},checkDay:function(a){var e=!1;return angular.forEach(t.$storage.workouts,function(t,r){var o=Number(t.date.slice(3,6)),n=Number(a);o==n&&(e=!0)}),e},checkDate:function(a){var e=!1;return angular.forEach(t.$storage.workouts,function(t,r){t.date==a&&(e=!0)}),e},clearLifts:function(){t.$storage.todaysLifts=[{name:"Select Lift",sets:[{reps:"0",wt:"0"}]}]},addSet:function(a){if(t.$storage.todaysLifts[a].sets.length<10){var e=angular.copy(_.last(t.$storage.todaysLifts[a].sets));t.$storage.todaysLifts[a].sets.push(e)}},removeSet:function(a){t.$storage.todaysLifts[a].sets.length>1&&t.$storage.todaysLifts[a].sets.splice(-1,1)},buildKgMap:function(){t.$storage.kgMap={},angular.forEach(t.$storage.liftData,function(a,e){t.$storage.kgMap[a.name]="heavykg"==a.weight?"kgs":"lbs"})},getChartData:function(a,e,r){var o=[],n=[],s=[],u={};if(angular.forEach(t.$storage.workouts,function(t,r){angular.forEach(t.lifts,function(r,i){r.name==a&&angular.forEach(r.sets,function(a,i){if(Number(a.reps)==Number(e))if(u[String(r.name)+String(a.reps)+String(t.date)]>0){var g=Number(u[String(r.name)+String(a.reps)+String(t.date)]);g<a.wt&&(o.pop(),s.pop(),o.push(Number(a.wt)),s.push({wt:Number(a.wt),date:t.date}))}else u[String(r.name)+String(a.reps)+String(t.date)]=Number(a.wt),o.push(Number(a.wt)),n.push(t.date),s.push({wt:Number(a.wt),date:t.date})})})}),1==r){0==o.length&&(o=[0]);var i=[o];return i}return 2==r?(0==n.length&&(n=["","No Data Available"]),n):s},removeLiftEntry:function(a){angular.forEach(t.$storage.liftData,function(e,r){e.name==a&&t.$storage.liftData.splice(r,1)})},addLiftToList:function(a){t.$storage.liftData.push({name:a,attr1:".",attr2:".",attr3:".",custom:!0,weight:"light"})},loadLiftFromCalendar:function(a,e){t.$storage.todaysLifts=angular.copy(e?t.$storage.workouts[a].lifts:t.$storage.workouts[a].lifts),t.$broadcast("loadedFromCalendar")},wipeWeights:function(){angular.forEach(t.$storage.todaysLifts,function(t,a){angular.forEach(t.sets,function(t,a){t.wt=0})})},buildRepList:function(a){var e=[];angular.forEach(t.$storage.workouts,function(t,r){angular.forEach(t.lifts,function(t,r){t.name==a&&angular.forEach(t.sets,function(t,a){e.push(Number(t.reps))})})});var r=_.unique(e),o=r.sort(function(t,a){return t-a}),n=[];return angular.forEach(o,function(t,a){n.push({reps:Number(t)})}),void 0==n[0]&&(n=[{reps:0}]),n},getBodyWeightData:function(a){var e=[],r=[];if(angular.forEach(t.$storage.workouts,function(t,a){t.bodyWeight&&(e.push(t.bodyWeight),r.push(t.date))}),1==a){0==e.length&&(e=[0]);var o=[e];return o}return 0==r.length&&(r=["","No Data Available"]),r},getMax:function(a,e){var r=[],o=[];angular.forEach(t.$storage.workouts,function(t,n){o.push({wt:t.bodyWeight,date:t.date}),angular.forEach(t.lifts,function(o,n){if(o.name==a){var s=[];angular.forEach(o.sets,function(a,r){Number(a.reps)==Number(e)&&(console.log("reps",e),s.push({wt:Number(a.wt),date:t.date}))});var u=_.max(s,function(t){return t.wt});r.push(u)}})});var n=_.max(r,function(t){return t.wt});return 1==r.length&&(n.only1=!0),"Body Weight"==a&&(n=o),n},updateGoals:function(a){angular.forEach(a,function(a,e){console.log("inserted goal for:",e),t.$storage.goalsMap[e]=a,console.log(t.$storage.goalsMap)})},getGoal:function(a){return t.$storage.goalsMap[a]},normalizeToWeeks:function(t,a){var r="none",o=[],n=[],s=t,u=e(s[0].date);r=u;var i=e(s[0].date),g=e(s[s.length-1].date),l=g-i,f=new Date(t[0].date),c=new Date(s[s.length-1].date);if(f.getFullYear()!=c.getFullYear()&&53!=g){var d=c.getFullYear()-f.getFullYear();g+=52*d,l=g-i}var h={},p={};angular.forEach(s,function(t,a){var r=e(t.date)-i,o=new Date(t.date);if(o.getFullYear()!=f.getFullYear()&&53!=r&&(r+=52*(o.getFullYear()-f.getFullYear())),p[r]){var n=_.max([Number(p[r].wt),Number(t.wt)]);h[r]={date:t.date,wt:n},p[r]={date:t,wt:n}}else p[r]=t,h[r]=t});for(var m,w=[],$=[],v=[],b=0,y=[],L=0;l+1>L;L++)w[L]=String(L),h[L]&&h[L].hasOwnProperty("wt")?(v[L]=Number(h[L].wt),y[L]=h[L].date,w[L]=String(L),b=h[L].wt,m=new Date(h[L].date)):v[L]=Number(b);$[0]=v;var o=w,n=[v];return 1==a?n:2==a?o:y}}}]);